# üîê –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

## –©–æ –¥–æ–¥–∞–Ω–æ:

### ‚úÖ –ê–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- –§–æ—Ä–º–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –∑ email —Ç–∞ –ø–∞—Ä–æ–ª–µ–º
- –§–æ—Ä–º–∞ –≤—Ö–æ–¥—É
- –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Å–µ—Å—ñ—ó
- –ö–Ω–æ–ø–∫–∞ –≤–∏—Ö–æ–¥—É

### ‚úÖ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ñ –æ–ø—Ü—ñ—ó
- –ö–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–±–∏—Ä–∞—î "–Ü–Ω—à–∏–π" —ñ –≤–≤–æ–¥–∏—Ç—å —Å–≤–æ—î –∑–Ω–∞—á–µ–Ω–Ω—è - –≤–æ–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è
- –ü—Ä–∏ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É –≤—Ö–æ–¥—ñ –≤—Å—ñ —Ä–∞–Ω—ñ—à–µ –≤–≤–µ–¥–µ–Ω—ñ –æ–ø—Ü—ñ—ó –¥–æ—Å—Ç—É–ø–Ω—ñ –≤ —Å–ø–∏—Å–∫—É
- –û–ø—Ü—ñ—ó –ø–æ–∑–Ω–∞—á–µ–Ω—ñ –µ–º–æ–¥–∑—ñ üë§

### ‚úÖ –ë–µ–∑–ø–µ–∫–∞
- –ö–æ–∂–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –±–∞—á–∏—Ç—å —Ç—ñ–ª—å–∫–∏ —Å–≤–æ—ó –∑–≤—ñ—Ç–∏
- –ö–æ–∂–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î —Å–≤–æ—ó –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ñ –æ–ø—Ü—ñ—ó
- Row Level Security (RLS) –∑–∞—Ö–∏—â–∞—î –¥–∞–Ω—ñ

## üöÄ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è (–¥–æ–¥–∞—Ç–∫–æ–≤–æ –¥–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –∫—Ä–æ–∫—ñ–≤)

### 1Ô∏è‚É£ –£–≤—ñ–º–∫–Ω—ñ—Ç—å Email Auth —É Supabase

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ Supabase Dashboard
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ **Authentication** > **Providers**
3. –£–≤—ñ–º–∫–Ω—ñ—Ç—å **Email** provider
4. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:
   - ‚úÖ Enable Email provider
   - ‚úÖ Confirm email (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –¥–ª—è production)
   - –î–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–æ–∂–Ω–∞ –≤–∏–º–∫–Ω—É—Ç–∏ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è email

### 2Ô∏è‚É£ –í–∏–∫–æ–Ω–∞–π—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ **SQL Editor**
2. –°–∫–æ–ø—ñ—é–π—Ç–µ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É `supabase-auth-schema.sql`
3. –í—Å—Ç–∞–≤—Ç–µ —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å Run
4. –¶–µ–π —Å–∫—Ä–∏–ø—Ç —Å—Ç–≤–æ—Ä–∏—Ç—å:
   - –¢–∞–±–ª–∏—Ü—é `user_profiles` –¥–ª—è –ø—Ä–æ—Ñ—ñ–ª—ñ–≤
   - –¢–∞–±–ª–∏—Ü—é `user_custom_options` –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏—Ö –æ–ø—Ü—ñ–π
   - RLS –ø–æ–ª—ñ—Ç–∏–∫–∏ –¥–ª—è –±–µ–∑–ø–µ–∫–∏
   - –¢—Ä–∏–≥–µ—Ä–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é

### 3Ô∏è‚É£ –û–Ω–æ–≤—ñ—Ç—å RLS –ø–æ–ª—ñ—Ç–∏–∫–∏ –¥–ª—è –¥–æ–≤—ñ–¥–Ω–∏–∫–æ–≤–∏—Ö —Ç–∞–±–ª–∏—Ü—å

–û—Å–∫—ñ–ª—å–∫–∏ —Ç–µ–ø–µ—Ä —î –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è, –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º —á–∏—Ç–∞—Ç–∏ –¥–æ–≤—ñ–¥–Ω–∏–∫–∏:

```sql
-- –î–æ–∑–≤–æ–ª–∏—Ç–∏ –≤—Å—ñ–º –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º —á–∏—Ç–∞—Ç–∏ –¥–æ–≤—ñ–¥–Ω–∏–∫–∏
CREATE POLICY "Authenticated users can read subdivisions" ON subdivisions
    FOR SELECT USING (auth.role() = 'authenticated');

CREATE POLICY "Authenticated users can read joint_with_options" ON joint_with_options
    FOR SELECT USING (auth.role() = 'authenticated');

-- –Ü —Ç–∞–∫ –¥–∞–ª—ñ –¥–ª—è –≤—Å—ñ—Ö –¥–æ–≤—ñ–¥–Ω–∏–∫–æ–≤–∏—Ö —Ç–∞–±–ª–∏—Ü—å...
-- –ê–±–æ –ø—Ä–æ—Å—Ç–æ:
CREATE POLICY "Authenticated users can read all" ON subdivisions FOR SELECT TO authenticated USING (true);
CREATE POLICY "Authenticated users can read all" ON joint_with_options FOR SELECT TO authenticated USING (true);
CREATE POLICY "Authenticated users can read all" ON drone_names FOR SELECT TO authenticated USING (true);
CREATE POLICY "Authenticated users can read all" ON drone_sizes FOR SELECT TO authenticated USING (true);
CREATE POLICY "Authenticated users can read all" ON camera_types FOR SELECT TO authenticated USING (true);
CREATE POLICY "Authenticated users can read all" ON video_frequencies FOR SELECT TO authenticated USING (true);
CREATE POLICY "Authenticated users can read all" ON control_frequencies FOR SELECT TO authenticated USING (true);
CREATE POLICY "Authenticated users can read all" ON target_types FOR SELECT TO authenticated USING (true);
CREATE POLICY "Authenticated users can read all" ON settlements FOR SELECT TO authenticated USING (true);
CREATE POLICY "Authenticated users can read all" ON bk_options FOR SELECT TO authenticated USING (true);
CREATE POLICY "Authenticated users can read all" ON initiation_board_options FOR SELECT TO authenticated USING (true);
CREATE POLICY "Authenticated users can read all" ON status_options FOR SELECT TO authenticated USING (true);
CREATE POLICY "Authenticated users can read all" ON reason_options FOR SELECT TO authenticated USING (true);
CREATE POLICY "Authenticated users can read all" ON loss_options FOR SELECT TO authenticated USING (true);
CREATE POLICY "Authenticated users can read all" ON operator_options FOR SELECT TO authenticated USING (true);
```

## üéØ –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î

### –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è:
1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–∞–ø–æ–≤–Ω—é—î —Ñ–æ—Ä–º—É (—ñ–º'—è, email, –ø–∞—Ä–æ–ª—å)
2. –ù–∞—Ç–∏—Å–∫–∞—î "–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è"
3. Supabase —Å—Ç–≤–æ—Ä—é—î –∞–∫–∞—É–Ω—Ç —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î email –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
4. –ü—ñ—Å–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –º–æ–∂–Ω–∞ –≤—Ö–æ–¥–∏—Ç–∏

### –í—Ö—ñ–¥:
1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å email —Ç–∞ –ø–∞—Ä–æ–ª—å
2. –ù–∞—Ç–∏—Å–∫–∞—î "–£–≤—ñ–π—Ç–∏"
3. –ó–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è –¥–∞–Ω—ñ —Ç–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ñ –æ–ø—Ü—ñ—ó
4. –ó'—è–≤–ª—è—î—Ç—å—Å—è –≥–æ–ª–æ–≤–Ω–∞ —Ñ–æ—Ä–º–∞ –∑–≤—ñ—Ç—ñ–≤

### –†–æ–±–æ—Ç–∞ –∑ –∫–∞—Å—Ç–æ–º–Ω–∏–º–∏ –æ–ø—Ü—ñ—è–º–∏:
1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–±–∏—Ä–∞—î "–Ü–Ω—à–∏–π" –≤ –±—É–¥—å-—è–∫–æ–º—É –ø–æ–ª—ñ
2. –í–≤–æ–¥–∏—Ç—å —Å–≤–æ—î –∑–Ω–∞—á–µ–Ω–Ω—è
3. –ì–µ–Ω–µ—Ä—É—î –∑–≤—ñ—Ç
4. ‚ú® –í–≤–µ–¥–µ–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è
5. –ü—Ä–∏ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É –≤—Ö–æ–¥—ñ —Ü–µ –∑–Ω–∞—á–µ–Ω–Ω—è –±—É–¥–µ –≤ —Å–ø–∏—Å–∫—É –∑ –ø–æ–∑–Ω–∞—á–∫–æ—é üë§

### –Ü—Å—Ç–æ—Ä—ñ—è –∑–≤—ñ—Ç—ñ–≤:
- –ö–æ–∂–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –±–∞—á–∏—Ç—å —Ç—ñ–ª—å–∫–∏ —Å–≤–æ—ó –∑–≤—ñ—Ç–∏
- –ù–µ –º–æ–∂–Ω–∞ –ø–æ–±–∞—á–∏—Ç–∏ —á–∏ –∑–º—ñ–Ω–∏—Ç–∏ —á—É–∂—ñ –∑–≤—ñ—Ç–∏

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Email (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —Å–≤—ñ–π SMTP:

1. **Authentication** > **Settings** > **Email Templates**
2. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ —à–∞–±–ª–æ–Ω–∏ –ª–∏—Å—Ç—ñ–≤
3. **Authentication** > **Settings** > **SMTP Settings**
4. –ü—ñ–¥–∫–ª—é—á—ñ—Ç—å —Å–≤—ñ–π SMTP —Å–µ—Ä–≤–µ—Ä

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–æ–¥–∞—Ç–æ–∫
2. –ú–∞—î –∑'—è–≤–∏—Ç–∏—Å—è —Ñ–æ—Ä–º–∞ –ª–æ–≥—ñ–Ω–∞
3. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
4. –£–≤—ñ–π–¥—ñ—Ç—å
5. –í–∏–±–µ—Ä—ñ—Ç—å "–Ü–Ω—à–∏–π" –≤ –ø–æ–ª—ñ "–û–ø–µ—Ä–∞—Ç–æ—Ä"
6. –í–≤–µ–¥—ñ—Ç—å "–¢–µ—Å—Ç–æ–≤–∏–π –æ–ø–µ—Ä–∞—Ç–æ—Ä"
7. –°—Ç–≤–æ—Ä—ñ—Ç—å –∑–≤—ñ—Ç
8. –í–∏–π–¥—ñ—Ç—å —Ç–∞ —É–≤—ñ–π–¥—ñ—Ç—å –∑–Ω–æ–≤—É
9. –í –ø–æ–ª—ñ "–û–ø–µ—Ä–∞—Ç–æ—Ä" –º–∞—î –∑'—è–≤–∏—Ç–∏—Å—è "–¢–µ—Å—Ç–æ–≤–∏–π –æ–ø–µ—Ä–∞—Ç–æ—Ä üë§"

## üìÅ –ù–æ–≤—ñ —Ñ–∞–π–ª–∏

- `auth.js` - –õ–æ–≥—ñ–∫–∞ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ —Ä–æ–±–æ—Ç–∏ –∑ –∫–∞—Å—Ç–æ–º–Ω–∏–º–∏ –æ–ø—Ü—ñ—è–º–∏
- `supabase-auth-schema.sql` - SQL –¥–ª—è —Ç–∞–±–ª–∏—Ü—å –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

## üîê –ë–µ–∑–ø–µ–∫–∞

‚úÖ **–©–æ –∑–∞—Ö–∏—â–µ–Ω–æ:**
- –ü–∞—Ä–æ–ª—ñ —Ö–µ—à—É—é—Ç—å—Å—è Supabase
- RLS –∑–∞—Ö–∏—â–∞—î –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- –¢–æ–∫–µ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–Ω–æ–≤–ª—é—é—Ç—å—Å—è
- –°–µ—Å—ñ—ó –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –±–µ–∑–ø–µ—á–Ω–æ

‚ö†Ô∏è **–î–ª—è production:**
- –£–≤—ñ–º–∫–Ω—ñ—Ç—å –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è email
- –ù–∞–ª–∞—à—Ç—É–π—Ç–µ —Å–≤—ñ–π SMTP
- –î–æ–¥–∞–π—Ç–µ reCAPTCHA (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
- –ù–∞–ª–∞—à—Ç—É–π—Ç–µ –ø–æ–ª—ñ—Ç–∏–∫–∏ –ø–∞—Ä–æ–ª—ñ–≤

## üí° –ü–æ—Ä–∞–¥–∏

1. **–î–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏**: –í–∏–º–∫–Ω—ñ—Ç—å "Confirm email" –≤ Settings
2. **–ó–∞–±—É–ª–∏ –ø–∞—Ä–æ–ª—å**: –î–æ–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü—ñ—é –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ `supabase.auth.resetPasswordForEmail()`
3. **–°–æ—Ü—ñ–∞–ª—å–Ω—ñ –º–µ—Ä–µ–∂—ñ**: –ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ Google, GitHub OAuth
4. **Multi-factor**: Supabase –ø—ñ–¥—Ç—Ä–∏–º—É—î 2FA

## üêõ Troubleshooting

### –ù–µ –ø—Ä–∞—Ü—é—î —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—è
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ —É–≤—ñ–º–∫–Ω–µ–Ω–∏–π Email Provider
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –ø–æ–º–∏–ª–∫–∏
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ –≤–∏–∫–æ–Ω–∞–Ω–æ SQL —Å–∫—Ä–∏–ø—Ç

### –ù–µ –∑'—è–≤–ª—è—é—Ç—å—Å—è –∫–∞—Å—Ç–æ–º–Ω—ñ –æ–ø—Ü—ñ—ó
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Å–æ–ª—å - –º–∞—é—Ç—å –±—É—Ç–∏ –ª–æ–≥–∏ "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –∫–∞—Å—Ç–æ–º–Ω—ñ –æ–ø—Ü—ñ—ó"
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ç–∞–±–ª–∏—Ü—é `user_custom_options` –≤ Database
- –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å —â–æ RLS –ø–æ–ª—ñ—Ç–∏–∫–∏ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ

### –ù–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –∑–≤—ñ—Ç–∏
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ —î `user_id` –≤ —Ç–∞–±–ª–∏—Ü—ñ `reports`
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ RLS –ø–æ–ª—ñ—Ç–∏–∫–∏ –¥–ª—è `reports`
- –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –ø–æ–º–∏–ª–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª—ñ

## ‚ú® –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä —É –≤–∞—Å —î –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∑:
- üîê –ê–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- üë§ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏–º–∏ –æ–ø—Ü—ñ—è–º–∏
- üìä –ü—Ä–∏–≤–∞—Ç–Ω–∏–º–∏ –∑–≤—ñ—Ç–∞–º–∏
- üîí –ë–µ–∑–ø–µ–∫–æ—é –¥–∞–Ω–∏—Ö
